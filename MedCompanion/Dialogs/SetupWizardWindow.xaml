<Window x:Class="MedCompanion.Dialogs.SetupWizardWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MedCompanion - Configuration"
        Height="620" Width="480"
        WindowStartupLocation="CenterScreen"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        ResizeMode="NoResize">

    <Window.Resources>
        <Style x:Key="ModernTextBox" TargetType="TextBox">
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Padding" Value="12,10"/>
            <Setter Property="BorderBrush" Value="#CCCCCC"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Background" Value="White"/>
        </Style>

        <Style x:Key="ModernPasswordBox" TargetType="PasswordBox">
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Padding" Value="12,10"/>
            <Setter Property="BorderBrush" Value="#CCCCCC"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Background" Value="White"/>
        </Style>

        <Style x:Key="PrimaryButton" TargetType="Button">
            <Setter Property="Height" Value="42"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Background" Value="#0078D4"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border"
                                Background="{TemplateBinding Background}"
                                CornerRadius="6">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#006CBD"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="border" Property="Background" Value="#CCCCCC"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="SecondaryButton" TargetType="Button">
            <Setter Property="Height" Value="42"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Background" Value="White"/>
            <Setter Property="Foreground" Value="#333333"/>
            <Setter Property="BorderBrush" Value="#CCCCCC"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="6">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#F5F5F5"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Border Background="White" CornerRadius="15" BorderBrush="#E0E0E0" BorderThickness="1">
        <Border.Effect>
            <DropShadowEffect BlurRadius="20" ShadowDepth="5" Opacity="0.3"/>
        </Border.Effect>

        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- En-tête -->
            <Border Grid.Row="0" Background="#0078D4" CornerRadius="15,15,0,0" Padding="25">
                <StackPanel>
                    <TextBlock Text="Bienvenue dans MedCompanion"
                               FontSize="24" FontWeight="Bold"
                               Foreground="White"
                               HorizontalAlignment="Center"/>
                    <TextBlock Text="Configuration initiale"
                               FontSize="14"
                               Foreground="#B0D4F1"
                               HorizontalAlignment="Center"
                               Margin="0,5,0,0"/>
                </StackPanel>
            </Border>

            <!-- Contenu -->
            <Grid Grid.Row="1" Margin="25">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Description -->
                <TextBlock Grid.Row="0"
                           TextWrapping="Wrap"
                           FontSize="13"
                           Foreground="#666666"
                           Margin="0,0,0,20">
                    <Run>Configurez la sécurité de votre application.</Run>
                    <LineBreak/>
                    <Run>Vous pouvez désactiver cette protection pour les tests.</Run>
                </TextBlock>

                <!-- Formulaire -->
                <StackPanel Grid.Row="1">
                    <!-- Mot de passe -->
                    <TextBlock Text="Mot de passe" FontSize="13" FontWeight="SemiBold" Margin="0,0,0,5"/>
                    <PasswordBox x:Name="PasswordBox"
                                 Style="{StaticResource ModernPasswordBox}"
                                 PasswordChanged="PasswordBox_PasswordChanged"/>
                    <TextBlock Text="Minimum 6 caractères"
                               FontSize="11" Foreground="#888888" Margin="0,3,0,15"/>

                    <!-- Confirmation mot de passe -->
                    <TextBlock Text="Confirmer le mot de passe" FontSize="13" FontWeight="SemiBold" Margin="0,0,0,5"/>
                    <PasswordBox x:Name="ConfirmPasswordBox"
                                 Style="{StaticResource ModernPasswordBox}"
                                 PasswordChanged="PasswordBox_PasswordChanged"/>

                    <!-- Code PIN -->
                    <TextBlock Text="Code PIN (4 chiffres)" FontSize="13" FontWeight="SemiBold" Margin="0,20,0,5"/>
                    <TextBox x:Name="PinBox"
                             Style="{StaticResource ModernTextBox}"
                             MaxLength="4"
                             PreviewTextInput="PinBox_PreviewTextInput"
                             TextChanged="PinBox_TextChanged"/>
                    <TextBlock Text="Pour une connexion rapide au quotidien"
                               FontSize="11" Foreground="#888888" Margin="0,3,0,0"/>

                    <!-- Message d'erreur -->
                    <TextBlock x:Name="ErrorText"
                               Text=""
                               Foreground="#D32F2F"
                               FontSize="12"
                               Margin="0,15,0,0"
                               TextWrapping="Wrap"/>
                </StackPanel>

                <!-- Boutons -->
                <StackPanel Grid.Row="2">
                    <Button x:Name="CreateButton"
                            Content="Créer et activer la sécurité"
                            Style="{StaticResource PrimaryButton}"
                            Click="CreateButton_Click"
                            IsEnabled="False"/>

                    <Button x:Name="SkipButton"
                            Content="Passer (désactiver la sécurité)"
                            Style="{StaticResource SecondaryButton}"
                            Margin="0,10,0,0"
                            Click="SkipButton_Click"/>

                    <TextBlock Text="Vous pourrez activer la sécurité plus tard dans les paramètres."
                               FontSize="11"
                               Foreground="#888888"
                               HorizontalAlignment="Center"
                               Margin="0,10,0,0"/>
                </StackPanel>
            </Grid>
        </Grid>
    </Border>
</Window>
